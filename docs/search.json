[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "CDC Causes of Death",
    "section": "",
    "text": "1 Introduction"
  },
  {
    "objectID": "data.html#description",
    "href": "data.html#description",
    "title": "2  Data",
    "section": "2.1 Description",
    "text": "2.1 Description"
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.2 Missing value analysis",
    "text": "2.2 Missing value analysis"
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "Code\nlibrary(dplyr)\nlibrary(readr)\nlibrary(dplyr)\nlibrary(forcats)\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(tidyr)\n\n\n\n\nCode\nlead_cod_2 = read_csv(\"NCHS_-_Leading_Causes_of_Death__United_States.csv\")\n\n# BY STATE\nlead_cod_2_by_state = lead_cod_2 %&gt;% filter(State != \"United States\")\n# lead_cod_2_by_state\n\n# LOOKING AT USA\nlead_cod_2_USA = lead_cod_2 %&gt;% filter(State == \"United States\")\n#lead_cod_2_USA\n\n# FILTER FOR 2008-2017\nlead_cod_2_USA_from_2008 = lead_cod_2_USA %&gt;% filter(Year &gt;= 2008)\nlead_cod_2_by_state_from_2008 = lead_cod_2_by_state %&gt;% filter(Year &gt;= 2008)\n\n\n\n\nCode\n####################################################\n\n# \"Total Aggregate Deaths by Cause from 1999 through 2017\"\n# Group to do a factor reorder\nlead_cod_2_USA_from_2008_mod &lt;- lead_cod_2_USA %&gt;% \n  #filter(Year &gt;= 2008) %&gt;%\n  mutate(`Cause Name` = as.factor(`Cause Name`)) %&gt;% # Ensure 'Cause Name' is a factor\n  group_by(`Cause Name`) %&gt;%\n  summarise(Total_Deaths = sum(Deaths, na.rm = TRUE)) %&gt;%\n  mutate(`Cause Name` = fct_reorder(`Cause Name`, Total_Deaths, .desc=TRUE)) %&gt;%\n  ungroup()\n\n# Now create the ggplot\nggplot(lead_cod_2_USA_from_2008_mod %&gt;% filter(`Cause Name` != \"All causes\"), aes(x = `Cause Name`, y = Total_Deaths)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  labs(x = \"Cause Name\", y = \"Total Deaths\", title = \"Top 10 Causes of Deaths from 1999 through 2017\")\n\n\n\n\n\nCode\n###################################################\n\n\n\n\nCode\n# DEATHS INCREASING OVER THE YEARS\nyearly_data &lt;- lead_cod_2_USA %&gt;%\n  group_by(Year) %&gt;%\n  summarise(Total_Deaths = sum(Deaths, na.rm = TRUE))\n\n# # Create a bar chart\n# ggplot(yearly_data, aes(x = Year, y = Total_Deaths)) +\n#   geom_bar(stat = \"identity\", position = \"dodge\") +\n#   scale_x_continuous(breaks = 1999:max(yearly_data$Year), limits = c(1998, 2018)) +\n#   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n#   labs(x = \"Year\", y = \"Total Deaths\", title = \"Total Deaths per Year from 2008 Onwards\")\n\n# A time series plot\nggplot(yearly_data, aes(x = Year, y = Total_Deaths)) +\n  geom_line() +  # Using geom_line for a time series plot\n  geom_point() +  # Optionally add points to highlight each data point\n  scale_x_continuous(breaks = 1999:max(yearly_data$Year), limits = c(1998, 2018)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  labs(x = \"Year\", y = \"Total Deaths\", title = \"Total Deaths for each Year from 1999 through 2017\") +\n  scale_y_continuous(breaks = seq(4e6, 5e6, by = 200000), \n                     limits = c(4e6, 5e6))\n\n\n\n\n\n\n\nCode\n# \"Total Deaths by Cause and Year from 2008-2017 Broken Down By Year\"\nlead_cod_2_USA_from_2008_with_year &lt;- lead_cod_2_USA_from_2008 %&gt;% \n  group_by(Year, `Cause Name`) %&gt;%\n  summarise(Total_Deaths = sum(Deaths, na.rm = TRUE)) \n\ncause_order = c(\"All causes\",\"Heart disease\",\"Cancer\",\"Stroke\", \n                \"CLRD\", \"Unintentional injuries\",\"Alzheimer's disease\", \n                \"Diabetes\", \"Influenza and pneumonia\", \"Kidney disease\",\"Suicide\" )\n\nlead_cod_2_USA_from_2008_with_year$`Cause Name` &lt;- factor(lead_cod_2_USA_from_2008_with_year$`Cause Name`, levels = cause_order)\n\n# Fill = Year\nggplot(lead_cod_2_USA_from_2008_with_year, aes(x = `Cause Name`, y = Total_Deaths, fill = as.factor(Year))) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_brewer(palette = \"Set1\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  labs(x = \"Cause Name\", y = \"Total Deaths\", fill = \"Year\", \n       title = \"Deaths by Cause and Year from 2008-2017 Broken Down By Year\")\n\n\nWarning in RColorBrewer::brewer.pal(n, pal): n too large, allowed maximum for palette Set1 is 9\nReturning the palette you asked for with that many colors\n\n\n\n\n\nWe are going to categorize types of death in 4 groups: Chronic Diseases, Acute Illnesses, Mental Health, Accidents. First, let’s observe the evolution across time.\n\n\nCode\n#Let's modify column names, filter out United States and All causes, as they are redundant for this anaylsis.\ndf = lead_cod_2 |&gt; filter(State != \"United States\")\ndf$Cause &lt;- df$`Cause Name`\ndf$Age &lt;- df$`Age-adjusted Death Rate`\ndf = df |&gt; select(-`113 Cause Name`) |&gt; select(-`Cause Name`) |&gt; select(-`Age-adjusted Death Rate`)\ndf = df |&gt; filter(Cause != 'All causes')\n\n#Here we create a category column according to the type of death\ndf$Category = ifelse(df$Cause %in% c(\"Heart disease\", \"Diabetes\", \"Alzheimer's disease\", \"Cancer\", \"CLRD\", \"Kidney disease\"), \"Chronic\",\n                 ifelse(df$Cause %in% c(\"Stroke\", \"Influenza and pneumonia\"), \"Acute\",\n                 ifelse(df$Cause == \"Suicide\", \"Mental\", \"Accident\")))\n\n#Aggregating by year and category\ndf_grouped = df |&gt; group_by(Year, Category) |&gt; summarise(TotalDeaths = sum(Deaths, na.rm = TRUE), .groups = 'drop')\ncolor_friendly = c(\"#E69F00\", \"#56B4E9\", \"#009E73\", \"#F0E442\")\n\n#Time series\nggplot(df_grouped, aes(x = Year, y = TotalDeaths, group = Category, color = Category)) +\n  geom_line(size = 1.5) + theme_minimal() + \n  labs(title = \"Deaths by Category Over Time\", x = \"Year\", y = \"Deaths\", color = \"Category\") +\n  scale_color_manual(values = color_friendly) +\n  scale_y_continuous(labels = scales::comma, breaks = scales::pretty_breaks(n = 8)) + \n  scale_x_continuous(breaks = scales::pretty_breaks(n = 8))\n\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\nThe time series plot helps us have an understanding of the magnitude of each category and the evolution across time. We can see that Chronic causes are around 30x the minor variety (Mental), making it challenging to analyze the growth of smaller series. Although it is clear that since 2010, Chronic causes have been increasing, we will create a cumulative chart to understand the evolution of each category.\nA cumulative percentage time series chart will help us compare relative changes of different categories from a common starting point.\n\n\nCode\n#First we have to calculate the percetage change for each period, and the accumulate it through the years:\ndf_wide &lt;- df_grouped |&gt; pivot_wider(names_from = Category, values_from = TotalDeaths, values_fill = list(TotalDeaths = 0))\ndf_wide &lt;- df_wide |&gt; mutate(across(-Year, ~(. / lag(.) - 1)))\ndf_wide[is.na(df_wide)] &lt;- 0\ndf_wide &lt;- df_wide |&gt; mutate(across(-Year, ~cumprod(1 + .) - 1))\ndf_wide &lt;- df_wide |&gt; pivot_longer(cols = -Year, names_to = \"Category\", values_to = \"CumulativeGrowth\")\n\n\nggplot(df_wide, aes(x = Year, y = CumulativeGrowth, color = Category)) +\n  geom_line(size = 1.5) + theme_minimal() + \n  labs(title = \"Cumulative Growth of Categories Over Time\", x = \"Year\", y = \"Cumulative Growth\") +\n  scale_y_continuous(labels = scales::percent_format(), breaks = scales::pretty_breaks(n = 8)) + \n  scale_x_continuous(breaks = scales::pretty_breaks(n = 8))+\n  scale_color_manual(values = color_friendly)\n\n\n\n\n\nWith the cumulative percentage evolution of deaths we can better understand the trends over time. We can make the following observations: - Deaths from chronic causes is the category that has remained most stable over time. This is despite the fact that the previous graph seemed to say that this category was the one that grew the most (an effect produced by the difference in magnitudes). However, there has been an upward trend since 2010. - Deaths from acute diseases showed a decreasing trend until 2012, but then began to grow again - Accidents and deaths from suicide (Mental) are growing at uncontrolled rates.\nFrom this arise two interesting questions to ask: - Which states lead the growth in deaths from suicide and accidents? - What types of acute deaths reflect the sharp decrease in the 2000s, and the recent increase since 2010? - Although chronic deaths seem more controlled in percentage terms, in absolute terms they accumulate more than 30x compared to the smallest category. What explains the recent increase in these types of deaths?\nTo answer the first question, we can build a Cleveland plot to understand which states are leading:\n\n\nCode\n# Filter the data for the specified conditions\ndf_rank &lt;- df %&gt;% select(-Age)|&gt; filter(Year %in% c(1999, 2017), Category == \"Mental\")\n\n# Calculate the percentual difference change from 2000 to 2017 for each state\ndf_rank &lt;- df_rank %&gt;%\n  pivot_wider(names_from = Year, values_from = Deaths) |&gt;\n  mutate(PercentChange = `2017`/`1999`-1) |&gt;\n  arrange(desc(PercentChange))\n\n# Create a vertical bar chart\nggplot(df_rank, aes(x = PercentChange, y = reorder(State, PercentChange))) +\n  geom_point(size = 3, color = \"brown\") +\n  geom_point(aes(color = \"green\"), size = 2) +\n  labs(title = \"Mental Deaths %Chg. - 1999 to 2017\", x = \"Percentual Change\", y = 'State') +\n  theme_bw() +\n  theme(panel.grid.major.x = element_blank(),\n    panel.grid.minor.x = element_blank(),\n    panel.grid.major.y = element_line(colour = \"grey60\", linetype = \"dashed\"))+\n  scale_x_continuous(labels = scales::percent_format(), breaks = scales::pretty_breaks(n = 8))+ \n  theme(legend.position = \"none\")\n\n\n\n\n\nCode\n#https://r-graphics.org/recipe-bar-graph-dot-plot\n\n\nWe can see that Utah, Idaho and North Dakota have seen the largest increase, while Delaware, Rhode Island and Louisiana the smallest.\n\n\nCode\n# Filter the data for the specified conditions\ndf_rank &lt;- df %&gt;% select(-Age)|&gt; filter(Year %in% c(1999, 2017), Category == \"Accident\")\n\n# Calculate the percentual difference change from 2000 to 2017 for each state\ndf_rank &lt;- df_rank %&gt;%\n  pivot_wider(names_from = Year, values_from = Deaths) |&gt;\n  mutate(PercentChange = `2017`/`1999`-1) |&gt;\n  arrange(desc(PercentChange))\n\n# Create a vertical bar chart\nggplot(df_rank, aes(x = PercentChange, y = reorder(State, PercentChange))) +\n  geom_point(size = 3, color = \"darkblue\") +\n  labs(title = \"Accident Deaths %Chg. - 1999 to 2017\", x = \"Percentual Change\", y = 'State') +\n  theme_bw() +\n  theme(panel.grid.major.x = element_blank(),\n    panel.grid.minor.x = element_blank(),\n    panel.grid.major.y = element_line(colour = \"grey60\", linetype = \"dashed\"))+\n  scale_x_continuous(labels = scales::percent_format(), breaks = scales::pretty_breaks(n = 8))+ \n  theme(legend.position = \"none\")\n\n\n\n\n\nCode\n#https://r-graphics.org/recipe-bar-graph-dot-plot\n\n\nNow we want to understand the underlying drivers of the changes across time for acute type of deaths.\n\n\nCode\n#First we manipulate the data to analyize Acute deaths only\ndf_acute &lt;- df |&gt; filter(Category == 'Acute') |&gt; select(Year, Cause, Deaths)\ndf_acute = df_acute |&gt; group_by(Year, Cause) |&gt; summarise(TotalDeaths = sum(Deaths, na.rm = TRUE), .groups = 'drop')\ndf_acute &lt;- df_acute |&gt; pivot_wider(names_from = Cause, values_from = TotalDeaths, values_fill = list(TotalDeaths = 0))\ndf_acute$Acute = df_acute$`Influenza and pneumonia` + df_acute$Stroke\n\n#Now we can understand the changes in trends by calculating percentual changes:\ndf_acute &lt;- df_acute |&gt; mutate(across(-Year, ~(. / lag(.) - 1)))\ndf_acute[is.na(df_acute)] &lt;- 0\ndf_acute &lt;- df_acute |&gt; mutate(across(-Year, ~cumprod(1 + .) - 1))\ndf_acute &lt;- df_acute |&gt; pivot_longer(cols = -Year, names_to = \"Dim\", values_to = \"CumulativeGrowth\")\ndf_acute &lt;- df_acute |&gt; mutate(Dim = if_else(Dim == \"Acute\", \"Total Acute\", Dim))\n\n#Now we can plot the evolution:\nggplot(df_acute, aes(x = Year, y = CumulativeGrowth, color = Dim)) +\n  geom_line(size = 1.5, aes(linetype = ifelse(Dim == \"Total Acute\", \"solid\", \"dashed\"))) +\n  labs(title = \"Breakdown of Acute Deaths Growth\", x = \"Year\", y = \"Cumulative Growth\") +\n  scale_y_continuous(labels = percent_format(), breaks = pretty_breaks(n = 8)) + \n  scale_x_continuous(breaks = pretty_breaks(n = 8)) +\n  scale_color_manual(values = c('brown', 'blue', 'Black')) +\n  guides(linetype = FALSE) +\n  theme(legend.position = \"bottom\")\n\n\nWarning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use \"none\" instead as\nof ggplot2 3.3.4.\n\n\n\n\n\nWe can observe the following: - Deaths by acute illnesses started to decrease after 2002, first led by a sharp decrease in Strokes. Still, in 2003, we also observed a declining rate of Influenza and Pneumonia, contributing to the overall trend. - From 2008 to 2017, the deaths caused by Influenza and Pneumonia were range-bound, although, with some volatility, they stayed somewhat constant. - However, Strokes started to pick up in 2013, which explains the overall trend observed in deaths by Acute illnesses."
  }
]